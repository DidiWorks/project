"""
证件照合规规则源（single source of truth）

仅定义“规则数据”，不包含任何处理逻辑。
当前版本：以 2 寸证件照为主，用于二次处理与合规交付引擎。
"""

# ================================
# 基础规格（默认规格：2 inch）
# ================================

# 输出成品尺寸（像素）
OUTPUT_SIZE = (413, 626)  # width, height（2 寸）

# 头部高度占比范围（头顶到下巴 / 整体高度）
# 按你给的一寸/二寸官方 cm 标准换算，大致在 57% ~ 63% 区间
# 这里统一取一个通用范围，目标值约 60%
HEAD_RATIO_RANGE = (0.57, 0.63)

# 眼睛所在的水平线相对画面高度的位置（眼睛中心 y / 整体高度）
# 二寸：官方说明为“略高于水平中线 1–2mm”，换算后约 0.46~0.48，这里取 0.47
EYE_LINE_RATIO = 0.47

# 输出 DPI（证件照通用标准）
DPI = 300

# 源图最短边建议阈值（用于分辨率风险提示，而不是硬性拒绝）
MIN_SHORT_EDGE = 250  # px


# ================================
# 结构化配置（供调用方使用）
# ================================

IDPHOTO_RULES = {
    "spec": "2inch",
    "output_size": OUTPUT_SIZE,             # (413, 626)
    "head_ratio_range": HEAD_RATIO_RANGE,   # (0.70, 0.72)
    "eye_line_ratio": EYE_LINE_RATIO,       # 0.45
    "dpi": DPI,                             # 300
    "min_short_edge": MIN_SHORT_EDGE,       # 250
}


# ================================
# 多规格尺寸预设（供前端/引擎选择输出尺寸）
# ================================

# 1 寸证件照常用尺寸：约 25mm × 35mm，对应 300 DPI 下约 295 × 413 像素
SIZE_PRESETS = {
    "2inch": {
        "label": "2 寸（413 × 626）",
        "output_size": OUTPUT_SIZE,
        "dpi": DPI,
        # 布局参数：约等价于
        # - 头顶距顶部约 0.5–0.8cm，下巴距底部约 1.5cm（头高约 57%~63%）
        # - 双眼略高于中心线约 1–2mm（≈ 0.47）
        "head_ratio_range": HEAD_RATIO_RANGE,   # 约 57%~63%
        "eye_line_ratio": EYE_LINE_RATIO,       # ≈ 0.47
    },
    "1inch": {
        "label": "1 寸（295 × 413）",
        "output_size": (295, 413),
        "dpi": DPI,
        # 一寸：
        # - 头顶距顶部约 0.3–0.5cm（≈ 10% 高度）
        # - 下巴距底部约 1cm（≈ 30% 高度）
        # - 眼睛基本在中心线附近
        "head_ratio_range": (0.57, 0.63),
        "eye_line_ratio": 0.50,
    },
}